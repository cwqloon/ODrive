


<!DOCTYPE html>
<!-- source: https://github.com/pages-themes/minimal/blob/master/_layouts/default.html -->
<html lang="en-US">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

<!-- Begin Jekyll SEO tag v2.7.1 -->
<title>CAN Bus Guide for ODrive | ODrive</title>
<meta name="generator" content="Jekyll v3.9.0" />
<meta property="og:title" content="CAN Bus Guide for ODrive" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="High performance motor control" />
<meta property="og:description" content="High performance motor control" />
<meta property="og:site_name" content="ODrive" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="CAN Bus Guide for ODrive" />
<script type="application/ld+json">
{"headline":"CAN Bus Guide for ODrive","description":"High performance motor control","url":"/can-guide.html","@type":"WebPage","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/style.css?v=aa255cb9d3205fd4306d7bf4d94dc69e802d15e8">
    <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <div>
          <h1><a href="/">ODrive Documentation</a></h1>

          

          <p>High performance motor control</p>
        </div>
        <div style="overflow-y: auto;">
          <ul id="navbar">
            
            <li class="navgroup">
              <p class="navheader">General</p>
              <ul>
                
                
                
                
                
                <li><a class="navitem" href="/" alt="Getting Started">Getting Started</a></li>
                
                
                
                
                <li><a class="navitem" href="/odrivetool" alt="ODrive Tool">ODrive Tool</a></li>
                
                
                
                
                <li><a class="navitem" href="/control-modes" alt="Control Modes">Control Modes</a></li>
                
                
                
                
                <li><a class="navitem" href="/commands" alt="Parameters & Commands">Parameters & Commands</a></li>
                
                
                
                
                <li><a class="navitem" href="/encoders" alt="Encoders">Encoders</a></li>
                
                
                
                
                <li><a class="navitem" href="/control" alt="Control Structure & Tuning">Control Structure & Tuning</a></li>
                
                
                
                
                <li><a class="navitem" href="/troubleshooting" alt="Troubleshooting">Troubleshooting</a></li>
                
                
                
                
                <li><a class="navitem" href="/specifications" alt="Specifications">Specifications</a></li>
                
                
                
                
                <li><a class="navitem" href="/ground-loops" alt="Ground Loops">Ground Loops</a></li>
                
                
              </ul>
            </li>
            
            <li class="navgroup">
              <p class="navheader">Tutorials</p>
              <ul>
                
                
                
                
                
                <li><a class="navitem" href="/hoverboard" alt="Hoverboard Guide">Hoverboard Guide</a></li>
                
                
                
                
                <li><a class="navitem" href="/migration" alt="Migration Guide">Migration Guide</a></li>
                
                
                
                
                <li><a class="navitem currentitem" href="/can-guide" alt="CAN Guide">CAN Guide</a></li>
                
                
              </ul>
            </li>
            
            <li class="navgroup">
              <p class="navheader">Interfaces & Protocols</p>
              <ul>
                
                
                
                
                
                <li><a class="navitem" href="/pinout" alt="Pinout">Pinout</a></li>
                
                
                
                
                <li><a class="navitem" href="/usb" alt="USB">USB</a></li>
                
                
                
                
                <li><a class="navitem" href="/uart" alt="UART">UART</a></li>
                
                
                
                
                <li><a class="navitem" href="/native-protocol" alt="Native Protocol">Native Protocol</a></li>
                
                
                
                
                <li><a class="navitem" href="/ascii-protocol" alt="ASCII Protocol">ASCII Protocol</a></li>
                
                
                
                
                <li><a class="navitem" href="/can-protocol" alt="CAN Protocol">CAN Protocol</a></li>
                
                
                
                
                <li><a class="navitem" href="/step-direction" alt="Step & Direction">Step & Direction</a></li>
                
                
                
                
                <li><a class="navitem" href="/rc-pwm" alt="RC PWM">RC PWM</a></li>
                
                
                
                
                <li><a class="navitem" href="/analog-input" alt="Analog Input">Analog Input</a></li>
                
                
                
                
                <li><a class="navitem" href="/endstops" alt="Homing & Endstops">Homing & Endstops</a></li>
                
                
                
                
                <li><a class="navitem" href="/thermistors" alt="Thermistors">Thermistors</a></li>
                
                
              </ul>
            </li>
            
            <li class="navgroup">
              <p class="navheader">API Reference</p>
              <ul>
                
                


<li>

  <input id="chk-ODrive" type="checkbox"  hidden />
  <p class="navitem">
    
    <label style="margin-left: 0px;" for="chk-ODrive" class="chevron"></label>
    <a href="/api/odrive">ODrive</a>
  </p>
  <ul class="expandable-list">

    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive.config">Config</a>
      </p>
    </li>
    <li>
    
      <input id="chk-ODrive.Can" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.Can" class="chevron"></label>
        <a href="/api/odrive.can">Can</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.can.config">Config</a>
          </p>
        </li>

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.can.error">Error</a>
          </p>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.can.protocol">Protocol</a>
          </p>
        </li>
      </ul>
    </li>
    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive.endpoint">Endpoint</a>
      </p>
    </li>
    <li>
    
      <input id="chk-ODrive.Axis" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.Axis" class="chevron"></label>
        <a href="/api/odrive.axis">Axis</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.axis.lockinconfig">LockinConfig</a>
          </p>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.axis.canconfig">CanConfig</a>
          </p>
        </li>
        <li>
        
          <input id="chk-ODrive.Axis.Config" type="checkbox"  hidden />
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <label style="margin-left: 0px;" for="chk-ODrive.Axis.Config" class="chevron"></label>
            <a href="/api/odrive.axis.config">Config</a>
          </p>
          <ul class="expandable-list">

            <li>
              <p class="navitem">
                <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
                <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
                <a href="/api/odrive.axis.config.calibrationlockin">CalibrationLockin</a>
              </p>
            </li>

          </ul>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.axis.tasktimes">TaskTimes</a>
          </p>
        </li>

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.axis.error">Error</a>
          </p>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.axis.axisstate">AxisState</a>
          </p>
        </li>
      </ul>
    </li>
    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive.thermistorcurrentlimiter">ThermistorCurrentLimiter</a>
      </p>
    </li>
    <li>
    
      <input id="chk-ODrive.OnboardThermistorCurrentLimiter" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.OnboardThermistorCurrentLimiter" class="chevron"></label>
        <a href="/api/odrive.onboardthermistorcurrentlimiter">OnboardThermistorCurrentLimiter</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.onboardthermistorcurrentlimiter.config">Config</a>
          </p>
        </li>

      </ul>
    </li>
    <li>
    
      <input id="chk-ODrive.OffboardThermistorCurrentLimiter" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.OffboardThermistorCurrentLimiter" class="chevron"></label>
        <a href="/api/odrive.offboardthermistorcurrentlimiter">OffboardThermistorCurrentLimiter</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.offboardthermistorcurrentlimiter.config">Config</a>
          </p>
        </li>

      </ul>
    </li>
    <li>
    
      <input id="chk-ODrive.Motor" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.Motor" class="chevron"></label>
        <a href="/api/odrive.motor">Motor</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.motor.currentcontrol">CurrentControl</a>
          </p>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.motor.config">Config</a>
          </p>
        </li>

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.motor.error">Error</a>
          </p>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.motor.motortype">MotorType</a>
          </p>
        </li>
      </ul>
    </li>
    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive.oscilloscope">Oscilloscope</a>
      </p>
    </li>
    <li>
    
      <input id="chk-ODrive.AcimEstimator" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.AcimEstimator" class="chevron"></label>
        <a href="/api/odrive.acimestimator">AcimEstimator</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.acimestimator.config">Config</a>
          </p>
        </li>

      </ul>
    </li>
    <li>
    
      <input id="chk-ODrive.Controller" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.Controller" class="chevron"></label>
        <a href="/api/odrive.controller">Controller</a>
      </p>
      <ul class="expandable-list">

        <li>
        
          <input id="chk-ODrive.Controller.Config" type="checkbox"  hidden />
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <label style="margin-left: 0px;" for="chk-ODrive.Controller.Config" class="chevron"></label>
            <a href="/api/odrive.controller.config">Config</a>
          </p>
          <ul class="expandable-list">

            <li>
              <p class="navitem">
                <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
                <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
                <a href="/api/odrive.controller.config.anticogging">Anticogging</a>
              </p>
            </li>

          </ul>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.controller.autotuning">Autotuning</a>
          </p>
        </li>

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.controller.error">Error</a>
          </p>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.controller.controlmode">ControlMode</a>
          </p>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.controller.inputmode">InputMode</a>
          </p>
        </li>
      </ul>
    </li>
    <li>
    
      <input id="chk-ODrive.Encoder" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.Encoder" class="chevron"></label>
        <a href="/api/odrive.encoder">Encoder</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.encoder.config">Config</a>
          </p>
        </li>

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.encoder.error">Error</a>
          </p>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.encoder.mode">Mode</a>
          </p>
        </li>
      </ul>
    </li>
    <li>
    
      <input id="chk-ODrive.SensorlessEstimator" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.SensorlessEstimator" class="chevron"></label>
        <a href="/api/odrive.sensorlessestimator">SensorlessEstimator</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.sensorlessestimator.config">Config</a>
          </p>
        </li>

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.sensorlessestimator.error">Error</a>
          </p>
        </li>
      </ul>
    </li>
    <li>
    
      <input id="chk-ODrive.TrapezoidalTrajectory" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.TrapezoidalTrajectory" class="chevron"></label>
        <a href="/api/odrive.trapezoidaltrajectory">TrapezoidalTrajectory</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.trapezoidaltrajectory.config">Config</a>
          </p>
        </li>

      </ul>
    </li>
    <li>
    
      <input id="chk-ODrive.Endstop" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.Endstop" class="chevron"></label>
        <a href="/api/odrive.endstop">Endstop</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.endstop.config">Config</a>
          </p>
        </li>

      </ul>
    </li>
    <li>
    
      <input id="chk-ODrive.MechanicalBrake" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.MechanicalBrake" class="chevron"></label>
        <a href="/api/odrive.mechanicalbrake">MechanicalBrake</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.mechanicalbrake.config">Config</a>
          </p>
        </li>

      </ul>
    </li>
    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive.tasktimer">TaskTimer</a>
      </p>
    </li>
    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive.tasktimes">TaskTimes</a>
      </p>
    </li>
    <li>
    
      <input id="chk-ODrive.SystemStats" type="checkbox"  hidden />
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <label style="margin-left: 0px;" for="chk-ODrive.SystemStats" class="chevron"></label>
        <a href="/api/odrive.systemstats">SystemStats</a>
      </p>
      <ul class="expandable-list">

        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.systemstats.usb">Usb</a>
          </p>
        </li>
        <li>
          <p class="navitem">
            <a class="levelbar">&nbsp;</a><a class="levelbar">&nbsp;</a>
            <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
            <a href="/api/odrive.systemstats.i2c">I2C</a>
          </p>
        </li>

      </ul>
    </li>

    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive.error">Error</a>
      </p>
    </li>
    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive.gpiomode">GpioMode</a>
      </p>
    </li>
    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive.streamprotocoltype">StreamProtocolType</a>
      </p>
    </li>
  </ul>
</li>
<li>

  <input id="chk-ODrive3" type="checkbox"  hidden />
  <p class="navitem">
    
    <label style="margin-left: 0px;" for="chk-ODrive3" class="chevron"></label>
    <a href="/api/odrive3">ODrive3</a>
  </p>
  <ul class="expandable-list">

    <li>
      <p class="navitem">
        <a class="levelbar">&nbsp;</a>
        <span style="margin-left: 7px; margin-right: 10px; float: inline-start;">&bull;</span>
        <a href="/api/odrive3.config">Config</a>
      </p>
    </li>

  </ul>
</li>
                
              </ul>
            </li>
            
            <li class="navgroup">
              <p class="navheader">For ODrive Developers</p>
              <ul>
                
                
                
                
                
                <li><a class="navitem" href="/developer-guide" alt="Firmware Developer Guide">Firmware Developer Guide</a></li>
                
                
                
                
                <li><a class="navitem" href="/configuring-vscode" alt="Configuring Visual Studio Code">Configuring Visual Studio Code</a></li>
                
                
                
                
                <li><a class="navitem" href="/configuring-eclipse" alt="Configuring Eclipse">Configuring Eclipse</a></li>
                
                
              </ul>
            </li>
            
            <li class="navgroup">
              <p class="navheader">Component Guides</p>
              <ul>
                
                
                
                
                
                <li><a class="navitem" href="https://docs.google.com/spreadsheets/d/12vzz7XVEK6YNIOqH0jAz51F5VUpc-lJEs3mmkWP1H4Y" alt="Motor Guide">Motor Guide</a></li>
                
                
                
                
                <li><a class="navitem" href="https://docs.google.com/spreadsheets/d/1OBDwYrBb5zUPZLrhL98ezZbg94tUsZcdTuwiVNgVqpU" alt="Encoder Guide">Encoder Guide</a></li>
                
                
              </ul>
            </li>
            
          </ul>
        </div>
        <div style="margin-top: 10px;">
          
          <p class="view"><a href="https://github.com/odriverobotics/ODrive">View the Project on GitHub <small>odriverobotics/ODrive</small></a></p>
          

          
          
          <p>Help improve these docs: submit edits using the link in the top right.</p>
          <p>If you need help, please search or ask the <a href=https://discourse.odriverobotics.com>ODrive Community</a>.</p>

          
        </div>
      </header>
      <section>

        <div class="pageactions">
          <div>
            <!-- edit icon taken from GitHub -->
            <svg transform="translate(0,1)" class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="10" height="12" aria-hidden="true">
              <path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"></path>
            </svg>
            
            <a href="https://www.github.com/madcowswe/ODrive/edit/master/docs/can-guide.md">edit on GitHub</a>
          </div>

          
        </div>


      <h1 id="can-bus-guide-for-odrive">CAN Bus Guide for ODrive</h1>

<p>ODrive v3 supports CAN 2.0b. We’ve built a <a href="/can-protocol.html">simple protocol</a> (named CANSimple) so that most ODrive functions can be controlled without a full CAN Open or similar stack.  This guide is intended for beginners to set up CAN on the ODrive and on their host device.  We will be focusing on Raspberry Pi and Arduino-compatible devices using the MCP2515 CAN Controller.</p>

<h2 id="what-is-can-bus">What is CAN bus?</h2>

<p>Borrowing from <a href="https://en.wikipedia.org/wiki/CAN_bus">Wikipeda</a>:</p>

<blockquote>
  <p>A Controller Area Network (CAN bus) is a robust vehicle bus standard designed to allow microcontrollers and devices to communicate with each other’s applications without a host computer. It is a message-based protocol, designed originally for multiplex electrical wiring within automobiles to save on copper, but it can also be used in many other contexts. For each device, the data in a frame is transmitted sequentially but in such a way that if more than one device transmits at the same time, the highest priority device can continue while the others back off. Frames are received by all devices, including by the transmitting device.</p>
</blockquote>

<p>In simple terms, CAN is a way of communicating between many devices over a single twisted pair of wires.  The signal is transmitted as the difference in voltage between the two wires (differential signalling), which makes it very robust against noise.  Instead of using a unique address (like I2C) or a select pin (like SPI), CAN <em>messages</em> have a unique ID that also acts as the priority.  At the beginning of a message frame, all devices talk and read at the same time.  As the message ID is transmitted, the lowest value “wins” and that message will be transmitted (ID <strong>0</strong> has the <em>highest</em> priority).  All other devices will wait for the next chance to send.  If two devices send the same message ID at the same time, they will conflict and a bus failure may occur.  Make sure your devices can never send the same message ID at the same time!</p>

<p>See also this great article from Danfoss that quickly describes how to put together the wiring for a CAN bus https://danfosseditron.zendesk.com/hc/en-gb/articles/360042232992-CAN-bus-physical-layer</p>

<p><img src="/screenshots/CAN_Bus_Drawing.png" alt="CAN picture" /></p>

<h2 id="why-use-can">Why use CAN?</h2>

<p>CAN is convenient for its simple and robust Physical Layer (PHY) that requires only a twisted pair of wires and a 120ohm termination resistor at each end.  It has low jitter and low latency, because there is no host computer.  It is relatively fast (CAN 2.0b supports 1 Mbps).  Messages are easy to configure and load with data.  Transceivers and controllers are inexpensive and widely available, thanks to its use in automotive.</p>

<h2 id="hardware-setup">Hardware Setup</h2>
<p>ODrive assumes the CAN PHY is a standard differential twisted pair in a linear bus configuration with 120 ohm termination resistance at each end. ODrive versions less than V3.5 include a soldered 120 ohm termination resistor, but ODrive versions V3.5 and greater implement a dip switch to toggle the termination.  ODrive uses 3.3v as the high output, but conforms to the CAN PHY requirement of achieving a differential voltage &gt; 1.5V to represent a “0”.  As such, it is compatible with standard 5V bus architectures.</p>

<h2 id="setting-up-can-on-odrive">Setting up CAN on ODrive</h2>

<p>CANSimple breaks the CAN Message ID into two parts:  An axis ID and a command ID.  By default, CAN is enabled on the ODrive, where Axis 0 has ID 0, and Axis 1 has ID 1.  The ID of each axis should be unique; each should be set via <code class="language-plaintext highlighter-rouge">odrivetool</code> before connecting to the bus with the command:</p>

<p><code class="language-plaintext highlighter-rouge">&lt;odrv&gt;.&lt;axis&gt;.config.can.node_id = &lt;number&gt;</code></p>

<p>By default, ODrive supports a value up to 63 (<code class="language-plaintext highlighter-rouge">0x3F</code>).  See <a href="/can-protocol.html">can-protocol.md</a> for more information.</p>

<p>You should also set the CAN bus speed on ODrive with the command <code class="language-plaintext highlighter-rouge">&lt;odrv&gt;.can.config.baud_rate = &lt;number&gt;</code></p>

<table>
  <thead>
    <tr>
      <th>Speed</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>125 kbps</td>
      <td>125000</td>
    </tr>
    <tr>
      <td>250 kbps</td>
      <td>250000</td>
    </tr>
    <tr>
      <td>500 kbps</td>
      <td>500000</td>
    </tr>
    <tr>
      <td>1000 kbps</td>
      <td>1000000</td>
    </tr>
  </tbody>
</table>

<p>That’s it!  You’re ready to set up your host device.</p>

<h3 id="example">Example</h3>
<pre><code class="language-Python">odrv0.axis0.config.can.node_id = 0
odrv0.axis1.config.can.node_id = 1
odrv0.can.config.baud_rate = 250000
</code></pre>

<h2 id="setting-up-a-raspberry-pi-for-can-communications">Setting up a Raspberry Pi for CAN communications</h2>
<p>First, you will need a CAN Hat for your Raspberry Pi.  We are using <a href="https://www.amazon.com/Raspberry-Long-Distance-Communication-Transceiver-SN65HVD230/dp/B07DQPYFYV">this CAN hat</a>.</p>

<p>Setting up the Raspberry Pi essentially involves the following:</p>
<ol>
  <li>Enable SPI communications to the MCP2515</li>
  <li>Install <code class="language-plaintext highlighter-rouge">can-utils</code> with <code class="language-plaintext highlighter-rouge">apt-get install can-utils</code></li>
  <li>Creating a connection between your application and the <code class="language-plaintext highlighter-rouge">can0</code> socket</li>
</ol>

<p>There are many tutorials for this process.  <a href="https://www.hackster.io/youness/how-to-connect-raspberry-pi-to-can-bus-b60235">This one is pretty good</a>, and <a href="https://www.raspberrypi.org/forums/viewtopic.php?t=296117">this recent forum post</a> also works.  However, be careful.  You have to set the correct parameters for the particular CAN hat you’re using!</p>

<ol>
  <li>Set the correct oscillator value</li>
</ol>

<p>We configure the MCP2515 in section 2.2 of the tutorial, but the hat we recommend uses a 12MHz crystal instead of a 16 MHz crystal.  If you’re not sure what value to use, the top of the <a href="https://en.wikipedia.org/wiki/Crystal_oscillator">oscillator</a> will have the value printed on it in MHz.</p>

<p>My Settings:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>dtparam=spi-on
dtoverlay=mcp2515-can0,oscillator=12000000,interrupt=25
dtoverlay=spi0-hw-cs
</code></pre></div></div>

<ol>
  <li>Use the correct CAN baud rate</li>
</ol>

<p>By default, ODrive uses 250 kbps (250000) but the tutorial is using 500 kbps.  Make sure you use the value set earlier on the ODrive.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo ip link set can0 up type can bitrate 250000
</code></pre></div></div>

<h3 id="wiring-odrive-to-can">Wiring ODrive to CAN</h3>
<p>The CANH and CANL pins on J2 are used for CAN communication.  Connect CANH to CANH on all other devices, and CANL to CANL.</p>

<p>If your ODrive is the “last” (furthest) device on the bus, you can use the on-board 120 Ohm termination resistor by switching the DIP switch to “CAN 120R”.  Otherwise, add an external resistor.</p>

<h3 id="verifying-communcation">Verifying Communcation</h3>

<p>By default, each ODrive axis will send a heartbeat message at 10Hz.  We can confirm our ODrive communication is working by starting the <code class="language-plaintext highlighter-rouge">can0</code> interface, and then reading from it:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo ip link set can0 up type can bitrate 250000
candump can0 -xct z -n 10
</code></pre></div></div>

<p>This will read the first 10 messages from the ODrive and stop.  If you’d like to see all messages, remove the <code class="language-plaintext highlighter-rouge">-n 10</code> part (hit CTRL+C to exit).  The other flags (x, c, t) are adding extra information, colouring, and a timestamp, respectively.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ candump can0 -xct z -n 10
 (000.000000)  can0  RX - -  001   [8]  00 00 00 00 01 00 00 00
 (000.001995)  can0  RX - -  021   [8]  00 00 00 00 08 00 00 00
 (000.099978)  can0  RX - -  001   [8]  00 00 00 00 01 00 00 00
 (000.101963)  can0  RX - -  021   [8]  00 00 00 00 08 00 00 00
 (000.199988)  can0  RX - -  001   [8]  00 00 00 00 01 00 00 00
 (000.201980)  can0  RX - -  021   [8]  00 00 00 00 08 00 00 00
 (000.299986)  can0  RX - -  001   [8]  00 00 00 00 01 00 00 00
 (000.301976)  can0  RX - -  021   [8]  00 00 00 00 08 00 00 00
 (000.399986)  can0  RX - -  001   [8]  00 00 00 00 01 00 00 00
 (000.401972)  can0  RX - -  021   [8]  00 00 00 00 08 00 00 00
</code></pre></div></div>

<p>Alternatively, if you have python can installed (<code class="language-plaintext highlighter-rouge">pip3 install python-can</code>), you can use the can.viewer script:</p>

<p><code class="language-plaintext highlighter-rouge">python3 -m can.viewer -c "can0" -i "socketcan"</code> which will give you a nice readout.  See <a href="https://python-can.readthedocs.io/en/master/scripts.html#can-viewer">the python-can docs</a> for an example.</p>

<h2 id="commanding-the-odrive">Commanding the ODrive</h2>

<p>Now that we’ve verified the communication is working, we can try commanding the ODrive.  Make sure your ODrive is configured and working properly over USB with <code class="language-plaintext highlighter-rouge">odrivetool</code> before continuing.  See the <a href="/">Getting Started Guide</a> for help with first-time configuration.</p>

<p>To move the ODrive, we use the command <code class="language-plaintext highlighter-rouge">Set Input Pos</code>, or cmd ID <code class="language-plaintext highlighter-rouge">0x00C</code>.  First we create a message with this ID, and then “OR” in the axis ID.  Then we create an 8-byte array of data with input position that we want, with a float value turned into bytes… this can be a pain though.</p>

<h2 id="dbc-files">DBC Files</h2>

<p>A DBC file (.dbc) is a database of all the messages and signals in a CAN protocol.  This file can be used with Python cantools to serialize and deserialize messages without having to handle the bitshifting etc yourself.  We have generated a .dbc for CANSimple for you!</p>

<ul>
  <li><a href="../tools/odrive-cansimple.dbc">CANSimple DBC File</a></li>
  <li><a href="../tools/create_can_dbc.py">CANSimple DBC Generator Script</a></li>
</ul>

<p>Instead of manually writing values into the data, we can create a dictionary of signal:value pairs and serialize the data according to the database definition.</p>

<ol>
  <li>Load the database into memory</li>
  <li>Use <code class="language-plaintext highlighter-rouge">encode_message()</code> to get a byte array representation of data for sending</li>
  <li>Use <code class="language-plaintext highlighter-rouge">decode_message()</code> to get a dictionary representation of data for receiving</li>
</ol>

<p>The <a href="../tools/can_dbc_example.py">CAN DBC Example</a> script shows you how this can be used.  This is the recommended method of serializing and deserializing.</p>

<p>If you’re using C++, then you can use the <a href="../Firmware/communication/can/can_helpers.hpp">CANHelpers</a> single-header library to do this instead, although the DBC file isn’t used.</p>


      </section>
      <!--<footer>
        
        <p>This project is maintained by <a href="https://github.com/odriverobotics">odriverobotics</a></p>
        
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>-->
    </div>
    <script src="/assets/js/scale.fix.js"></script>
    
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-93396600-3', 'auto');
      ga('send', 'pageview');
    </script>
    
    <script type="text/javascript">
      // Rewrite all links that start with "../" to point to the GitHub repo
      window.onload = function(){
        var links = document.links;
        var i = links.length;
        while (i--) {
          if (links[i].getAttribute("href").slice(0, 3) == "../") {
            links[i].href = "https://github.com/madcowswe/ODrive/blob/master/" + links[i].getAttribute("href").slice(3);
          }
          if (links[i].getAttribute("href").slice(0, 15) == "getting-started") {
            links[i].href = "/" + links[i].getAttribute("href").slice(15);
          }
        }
      }
    </script>
    <script>
      // Scroll the navbar to the position of the selected item
      var element = document.getElementsByClassName("currentitem")[0];
      element.scrollIntoView(false);
    </script>
  </body>
</html>

